<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>前端跨域问题解决方案 | AngryQi</title>
  
  <meta name="description" content="# 背景 项目由于需要前后端联调，但是前后端不处于同一个host下，所以需要使用某些方法解决跨域问题，目前所知道的解决方法主要有两种： ">
    <meta name="keywords" content="vue 跨域 Chrome">
  <link rel="preload" href="https://pldq.gitee.io/assets/css/0.styles.b1164d51.css" as="style"><link rel="preload" href="https://pldq.gitee.io/assets/js/app.2411ec71.js" as="script"><link rel="preload" href="https://pldq.gitee.io/assets/js/3.851c330d.js" as="script"><link rel="preload" href="https://pldq.gitee.io/assets/js/7.b83aea1c.js" as="script"><link rel="preload" href="https://pldq.gitee.io/assets/js/14.f40b6248.js" as="script"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/10.bef563c9.js"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/11.743d948a.js"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/12.f4c3dc72.js"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/13.91441604.js"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/15.623ac902.js"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/16.5715ddd1.js"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/17.224f8cf6.js"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/4.75e08570.js"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/5.7cb4259c.js"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/6.b74c953f.js"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/8.1082e4f1.js"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/9.d502b2d0.js"><link rel="prefetch" href="https://pldq.gitee.io/assets/js/vendors~flowchart.e276d141.js">
  <link rel="stylesheet" href="https://pldq.gitee.io/assets/css/0.styles.b1164d51.css">
</head>
<body>
<div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/default-avatar.png" alt="AngryQi" class="logo"> <span class="site-name can-hide">AngryQi</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/troubleshooting/index.html" class="nav-link">
  问题处理
</a></div><div class="nav-item"><a href="/knowledgeUniverse/index.html" class="nav-link">
  知识宇宙
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/troubleshooting/index.html" class="nav-link">
  问题处理
</a></div><div class="nav-item"><a href="/knowledgeUniverse/index.html" class="nav-link">
  知识宇宙
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端跨域问题解决方案</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/knowledgeuniverse/crosssitesolutions/qian-duan-kua-yu-wen-ti-jie-jue-fang-an.html#背景" class="sidebar-link">背景</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/knowledgeuniverse/crosssitesolutions/qian-duan-kua-yu-wen-ti-jie-jue-fang-an.html#使用跨域浏览器" class="sidebar-link">使用跨域浏览器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledgeuniverse/crosssitesolutions/qian-duan-kua-yu-wen-ti-jie-jue-fang-an.html#chrome-跨域访问设置" class="sidebar-link">Chrome 跨域访问设置</a></li></ul></li><li><a href="/knowledgeuniverse/crosssitesolutions/qian-duan-kua-yu-wen-ti-jie-jue-fang-an.html#使用-devserver-解决跨域问题" class="sidebar-link">使用 devServer 解决跨域问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/knowledgeuniverse/crosssitesolutions/qian-duan-kua-yu-wen-ti-jie-jue-fang-an.html#补充" class="sidebar-link">补充</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p>项目由于需要前后端联调，但是前后端不处于同一个host下，所以需要使用某些方法解决跨域问题，目前所知道的解决方法主要有两种：</p> <ol><li>使用跨域浏览器解决跨域问题</li> <li>使用 <code>devServer</code> 创建代理解决跨域问题</li></ol> <h2 id="使用跨域浏览器"><a href="#使用跨域浏览器" class="header-anchor">#</a> 使用跨域浏览器</h2> <p><strong>优点</strong><br>
  1. 方便，简单，不需要对登录进行处理，浏览器每次请求会自动带上 <code>Cookies</code></p> <p><strong>缺点</strong><br>
  1. 如果后端配置了跨域拦截器，需要将拦截器禁用才能使用</p> <h3 id="chrome-跨域访问设置"><a href="#chrome-跨域访问设置" class="header-anchor">#</a> Chrome 跨域访问设置</h3> <ol><li>新建一个 chrome 快捷方式，右键-&gt;属性-&gt;快捷方式-&gt;目标，添加对应参数</li> <li>通过快捷方式打开谷歌浏览器</li></ol> <p>对应参数需要根据自己 Chrome 版本使用不同的参数</p> <table><thead><tr><th>版本</th> <th>参数</th> <th>备注</th></tr></thead> <tbody><tr><td>49之前</td> <td>--disable-web-security --user-data-dir=E:\ChromeDev --allow-running-insecure-content</td> <td>--user-data-dir的路径可以自己随意指定一个空白文件夹</td></tr> <tr><td>49之后</td> <td>--args --disable-web-security --user-data-dir</td> <td></td></tr></tbody></table> <h2 id="使用-devserver-解决跨域问题"><a href="#使用-devserver-解决跨域问题" class="header-anchor">#</a> 使用 <code>devServer</code> 解决跨域问题</h2> <p>如果使用了 <code>Webpack</code>，也可以使用 <code>devServer</code> 解决跨域问题</p> <p><strong>优点</strong><br>
  1. 自由度高，可以配置Headers等内容</p> <details class="custom-block details"><summary>vue.config.js 中的跨域配置</summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'^api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">'https://ip/'</span><span class="token punctuation">,</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></details> <h3 id="补充"><a href="#补充" class="header-anchor">#</a> 补充</h3> <p>仅仅使用上面配置对于具有跨域过滤器的后端不能生效，后端会校验 <code>Headers</code> 中 <code>Refer</code>、<code>Sec-Fetch-Site</code>、<code>Sec-Fetch-Mode</code>、<code>Sec-Fetch-Dest</code>，所以需要将配置进行改造</p> <details class="custom-block details"><summary>vue.config.js 中的跨域配置</summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'^api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">'https://ip/'</span><span class="token punctuation">,</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        logLevel<span class="token operator">:</span> <span class="token string">'debug'</span><span class="token punctuation">,</span>
        secure<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token function-variable function">onProxyReq</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">proxyReq<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 移除跨域 headers</span>
          proxyReq<span class="token punctuation">.</span><span class="token function">removeHeader</span><span class="token punctuation">(</span><span class="token string">'sec-fetch-dest'</span><span class="token punctuation">)</span>
          proxyReq<span class="token punctuation">.</span><span class="token function">removeHeader</span><span class="token punctuation">(</span><span class="token string">'sec-fetch-site'</span><span class="token punctuation">)</span>
          proxyReq<span class="token punctuation">.</span><span class="token function">removeHeader</span><span class="token punctuation">(</span><span class="token string">'sec-fetch-mode'</span><span class="token punctuation">)</span>
          proxyReq<span class="token punctuation">.</span><span class="token function">removeHeader</span><span class="token punctuation">(</span><span class="token string">'referer'</span><span class="token punctuation">)</span>
          proxyReq<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'cookie'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></details></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新日期:</span> <span class="time">2021-1-21 20:38:29</span></div></footer> <!---->  <div class="comments-container"></div></main></div><div class="global-ui"><!----><!----></div></div>
<script src="https://pldq.gitee.io/assets/js/app.2411ec71.js" defer></script><script src="https://pldq.gitee.io/assets/js/3.851c330d.js" defer></script><script src="https://pldq.gitee.io/assets/js/7.b83aea1c.js" defer></script><script src="https://pldq.gitee.io/assets/js/14.f40b6248.js" defer></script>
</body>
</html>
